<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Biostatistics in R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="These are a collection of tutorials that I have found useful in statistical applications.">
  <meta name="generator" content="bookdown 0.0.64 and GitBook 2.6.7">

  <meta property="og:title" content="Biostatistics in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These are a collection of tutorials that I have found useful in statistical applications." />
  <meta name="github-repo" content="sahirbhatnagar/biosR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Biostatistics in R" />
  
  <meta name="twitter:description" content="These are a collection of tutorials that I have found useful in statistical applications." />
  

<meta name="author" content="Sahir Rai Bhatnagar">

<meta name="date" content="2016-04-14">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="intro.html">
<link rel="next" href="methods.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/htmlwidgets-0.6/htmlwidgets.js"></script>
<script src="libs/d3-3.3.8/d3.min.js"></script>
<script src="libs/dagre-0.4.0/dagre-d3.min.js"></script>
<link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet" />
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/chromatography-0.1/chromatography.js"></script>
<script src="libs/DiagrammeR-binding-0.8.2/DiagrammeR.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Biostatistics in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Prerequisites</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>3</b> Simulations</a><ul>
<li class="chapter" data-level="3.1" data-path="simulations.html"><a href="simulations.html#what-is-a-simulation-study"><i class="fa fa-check"></i><b>3.1</b> What is a simulation study?</a></li>
<li class="chapter" data-level="3.2" data-path="simulations.html"><a href="simulations.html#why-conduct-a-simulation-study"><i class="fa fa-check"></i><b>3.2</b> Why conduct a simulation study?</a><ul>
<li class="chapter" data-level="3.2.1" data-path="simulations.html"><a href="simulations.html#understanding-the-behaviour-of-a-statistical-quantity"><i class="fa fa-check"></i><b>3.2.1</b> Understanding the behaviour of a statistical quantity</a></li>
<li class="chapter" data-level="3.2.2" data-path="simulations.html"><a href="simulations.html#model-selection"><i class="fa fa-check"></i><b>3.2.2</b> Model selection</a></li>
<li class="chapter" data-level="3.2.3" data-path="simulations.html"><a href="simulations.html#model-assessment"><i class="fa fa-check"></i><b>3.2.3</b> Model assessment</a></li>
<li class="chapter" data-level="3.2.4" data-path="simulations.html"><a href="simulations.html#calculating-measures-of-uncertainty"><i class="fa fa-check"></i><b>3.2.4</b> Calculating measures of uncertainty</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="methods.html"><a href="methods.html"><i class="fa fa-check"></i><b>4</b> Methods</a></li>
<li class="chapter" data-level="5" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>5</b> Applications</a></li>
<li class="chapter" data-level="6" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>6</b> Final Words</a></li>
<li class="chapter" data-level="7" data-path="placeholder.html"><a href="placeholder.html"><i class="fa fa-check"></i><b>7</b> Placeholder</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Biostatistics in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulations" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Simulations</h1>
<p>In this chapter you’ll learn how to conduct a simulation study. The word <em>simulation</em> gets thrown around alot as a trivial concept, though I have found that this term is often either misused by epidemiologists or abused by statisticians. A source of this confusion arises from the fact that it is not well defined. This is not by accident. A simulation study has so many moving parts that it would be impossible to characterize in a single word. However, there are some common underlying themes behind simulation studies. For this reason, the main focus here will be on creating a general roadmap for conducting these types of analyses, that can be applied to your specific setting.</p>
<div id="what-is-a-simulation-study" class="section level2">
<h2><span class="header-section-number">3.1</span> What is a simulation study?</h2>
<p>Here are some results from a Google Search:</p>
<ol style="list-style-type: decimal">
<li>A numerical technique for conducting experiments on the computer <span class="citation">(Davidian <a href="placeholder.html#ref-marie">2005</a>)</span></li>
<li>Simulations provide a powerful technique for answering a broad set of methodological and theoretical questions and provide a flexible framework to answer specific questions relevant to one’s own research<span class="citation">(Hallgren <a href="placeholder.html#ref-hallgren2013conducting">2013</a>)</span></li>
</ol>
<p>I prefer the second definition because it speaks to the generality of simulations. I see simulations in the following way<a href="placeholder.html#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a>:</p>
<p><div id="htmlwidget-3910" style="width:672px;height:480px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-3910">{"x":{"diagram":"\ngraph LR\nA((Input 1))-->B{Procedure}\nD((Input 2))-->B{Procedure}\nE((Input 3))-->B{Procedure}\nB-->C[Output 1]\nB-->F[Output 1]\nB-->G[Output 1]\n"},"evals":[],"jsHooks":[]}</script></p>
<p>There are three crucial components to any simulation study:</p>
<ol style="list-style-type: decimal">
<li><strong>Procedure</strong> - something that doesn’t change throughout the simulation study</li>
<li><strong>Input</strong>: <em>several</em> values of the same quantity that are passed to the procedure.</li>
<li><strong>Output</strong>: result from the procedure being applied to the inputs. Should be equal in length to the number of outputs. The following toy example illustrates this point:</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">f_sample_median &lt;-<span class="st"> </span>function(true_mean) {
  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean =</span> true_mean, <span class="dt">sd =</span> <span class="dv">1</span>)
  <span class="kw">median</span>(x)
}

(means &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>))</code></pre></div>
<pre><code>## [1] 1 2 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(sample_medians &lt;-<span class="st"> </span><span class="kw">sapply</span>(means, f_sample_median))</code></pre></div>
<pre><code>## [1] 1.119985 1.860057 2.964291</code></pre>
<p>So here, <code>f_sample_median</code> is the procedure that generates 20 random numbers from a normal distribution with standard deviation 1 and a user specified mean, and outputs the sample median. <code>means</code> is the input vector of user specified means, and <code>sample_medians</code> is the output:</p>
<p><div id="htmlwidget-6479" style="width:672px;height:480px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-6479">{"x":{"diagram":"\ngraph LR\nA((1))-->B{f_sample_median}\nD((2))-->B\nE((3))-->B\nB-->C[1.12]\nB-->F[1.86]\nB-->G[2.96]\n"},"evals":[],"jsHooks":[]}</script></p>
<p>Using this very general definition of the word <em>simulation</em>, I see the following analysis techinques as a type of simulation.</p>
<p><div id="htmlwidget-3198" style="width:672px;height:480px;" class="DiagrammeR html-widget"></div>
<script type="application/json" data-for="htmlwidget-3198">{"x":{"diagram":"\ngraph TB\nsq[Simulation] --> ci[Bootstrap]\nsq --> A[Cross Validation]\nsq --> B[Sensitivity Analysis]\nsq --> C[Permutations]\nclassDef green fill:#9f6,stroke:#333,stroke-width:2px;\nclassDef orange fill:#f96,stroke:#333,stroke-width:4px;\nclass sq green\n"},"evals":[],"jsHooks":[]}</script></p>
<p>Boostrap, Cross Validation, Sensitivity analysis and Permutations are all similar in that they have multiple inputs with an equal number of outputs, with a fixed procedure. What differentiates them is the context in which they can be applied. The technique you choose depends entirely on the question you’re trying to answer.</p>
</div>
<div id="why-conduct-a-simulation-study" class="section level2">
<h2><span class="header-section-number">3.2</span> Why conduct a simulation study?</h2>
<p>The most common applications of simulation studies are the following</p>
<div id="understanding-the-behaviour-of-a-statistical-quantity" class="section level3">
<h3><span class="header-section-number">3.2.1</span> Understanding the behaviour of a statistical quantity</h3>
<div id="example-1-the-central-limit-theorem" class="section level4">
<h4><span class="header-section-number">3.2.1.1</span> Example 1: The Central Limit Theorem</h4>
<p>The <a href="https://en.wikipedia.org/wiki/Central_limit_theorem">Central Limit Theorem</a> is one of the most famous theorems in statistics. This theorem basically states that the sum or mean of independent random variables (with finite mean and variance) will converge to a normal distribution, regardless of the distribution of the random variables. The following figure clearly illustrates this point <span class="citation">(Joseph <a href="placeholder.html#ref-joseph">2010</a>)</span></p>
<p><img src="images/clt.png" alt="" /><!-- --></p>
<p>In this example, the statistical quantity of interest is the sum of the random variables. We want to verify that the sum of the time it takes to get to Purvis hall follows a normal distribution. Of course the CLT can be proven mathematically, but we can also simulate random numbers from different distributions in <code>R</code> to numerically verify this result:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># number of random numbers to generate from each distribution</span>
n &lt;-<span class="st"> </span><span class="fl">1e4</span>

<span class="co"># true parameters of each distribution</span>
mean.walk &lt;-<span class="st"> </span><span class="dv">4</span> ; var.walk &lt;-<span class="st"> </span><span class="dv">1</span>
mean.bus &lt;-<span class="st"> </span>(<span class="dv">4+16</span>)/<span class="dv">2</span> ; var.bus &lt;-<span class="st"> </span>(<span class="dv">16-4</span>)^<span class="dv">2</span>/<span class="dv">12</span>
mean.ride &lt;-<span class="st"> </span><span class="dv">8</span> ; var.ride &lt;-<span class="st"> </span><span class="dv">8</span> 
mean.climb &lt;-<span class="st"> </span><span class="dv">6</span>*<span class="fl">0.5</span> ; var.climb &lt;-<span class="st"> </span><span class="dv">6</span>*<span class="fl">0.5</span>^<span class="dv">2</span>
mean.fall &lt;-<span class="st"> </span><span class="dv">1</span>/<span class="dv">4</span> ; var.fall &lt;-<span class="st"> </span><span class="dv">1</span>/<span class="dv">4</span>^<span class="dv">2</span>

<span class="co"># generate random samples from each distribution</span>
walk &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, mean.walk, var.walk)
bus &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dv">4</span>, <span class="dv">16</span>)
ride &lt;-<span class="st"> </span><span class="kw">rpois</span>(n, mean.ride)
climb &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, <span class="dt">shape =</span> <span class="dv">6</span>, <span class="dt">scale =</span> <span class="fl">0.5</span>)
fall &lt;-<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> <span class="dv">1</span>/mean.fall)

<span class="co"># true mean and variance of sum</span>
mean.sum &lt;-<span class="st"> </span>mean.walk+mean.bus+mean.ride+mean.climb+mean.fall
var.sum &lt;-<span class="st"> </span>var.walk+var.bus+var.ride+var.climb+var.fall

<span class="co"># create a data frame of the data and calculate the sum for each sample</span>
DT &lt;-<span class="st"> </span><span class="kw">data.frame</span>(walk, bus, ride, climb, fall)
DT$sum &lt;-<span class="st"> </span><span class="kw">apply</span>(DT,<span class="dv">1</span>,sum)

<span class="co"># plot each histogram and superimpose theoretical </span>
<span class="co"># distribution to empirical one</span>
<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))
<span class="kw">hist</span>(walk, <span class="dt">main=</span><span class="st">&quot;Normal(mean=4,sd=1)&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">hist</span>(bus, <span class="dt">main=</span><span class="st">&quot;Uniform(a=4,b=16)&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">hist</span>(ride, <span class="dt">main=</span><span class="st">&quot;Poisson(lambda=8)&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">hist</span>(climb, <span class="dt">main=</span><span class="st">&quot;Gamma(shape=6, scale=0.5)&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">hist</span>(fall, <span class="dt">main=</span><span class="st">&quot;Exponential(rate=4)&quot;</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">hist</span>(DT$sum, <span class="dt">xlab=</span><span class="st">&#39;Total time&#39;</span>, <span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&quot;Distribution of Sum, n = &quot;</span>,n), <span class="dt">freq=</span><span class="ot">FALSE</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x,<span class="dt">mean=</span>mean.sum,<span class="dt">sd=</span><span class="kw">sqrt</span>(var.sum)),<span class="dv">0</span>,<span class="dv">50</span>,<span class="dt">add=</span><span class="ot">TRUE</span>,<span class="dt">lwd=</span><span class="dv">2</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-6-1.png" alt="" /><!-- --></p>
</div>
<div id="example-2-power-calculation" class="section level4">
<h4><span class="header-section-number">3.2.1.2</span> Example 2: Power Calculation</h4>
<p>When performing <a href="https://en.wikipedia.org/wiki/Student%27s_t-test">Student’s t-test</a> to compare difference in means between two group, it is a useful exercise to determine the effect of unequal sample sizes in the comparison groups on <strong>power</strong>. Large imbalances generally will not have adequate statistical power to detect even large effect sizes associated with a factor, leading to a high Type II error rate as shown in the figure below:</p>
<p><img src="bookdown-demo_files/figure-html/unnamed-chunk-8-1.png" alt="" /><!-- --></p>
<p>To jusity this reasoning I performed a power analysis for different group sizes. I considered the following group sizes:</p>
<ol style="list-style-type: decimal">
<li>n1 = 28, n2 = 1406: n1 represents 2% of the entire sample size of 1434</li>
<li>n1 = 144, n2 = 1290: n1 represents 10% of the entire sample size of 1434</li>
<li>n1 = 287, n2 = 1147: n1 represents 20% of the entire sample size of 1434</li>
<li>n1 = 430, n2 = 1004: n1 represents 30% of the entire sample size of 1434</li>
<li>n1 = 574, n2 = 860: n1 represents 40% of the entire sample size of 1434</li>
<li>n1 = 717, n2 = 717: equal size groups (this is optimal because it leads to the highest power for a given effect size)</li>
</ol>
<p>In the figure above we plotted the power curves for the <span class="math inline">\(t\)</span>-test, as a function of the effect size, assuming a Type I error rate of 5%.</p>
<p>Here is the code used to produce the above plot</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(pwr) <span class="co"># for power calcs</span>
<span class="kw">library</span>(dplyr) <span class="co"># for data manipulation</span>
<span class="kw">library</span>(tidyr) <span class="co"># for data manipulation</span>
<span class="kw">library</span>(ggplot2) <span class="co"># for plotting power curves</span>

<span class="co"># Generate power calculations</span>
ptab &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="ot">NULL</span>, <span class="ot">NULL</span>)       

for (i in <span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">length.out =</span> <span class="dv">200</span>)){
  pwrt1 &lt;-<span class="st"> </span><span class="kw">pwr.t2n.test</span>(<span class="dt">n1 =</span> <span class="dv">28</span>, <span class="dt">n2 =</span> <span class="dv">1406</span>, 
                        <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">power =</span> <span class="ot">NULL</span>, 
                        <span class="dt">d =</span> i, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)
  pwrt2 &lt;-<span class="st"> </span><span class="kw">pwr.t2n.test</span>(<span class="dt">n1 =</span> <span class="dv">144</span>, <span class="dt">n2 =</span> <span class="dv">1290</span>, 
                        <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">power =</span> <span class="ot">NULL</span>, 
                        <span class="dt">d =</span> i, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)
  pwrt3 &lt;-<span class="st"> </span><span class="kw">pwr.t2n.test</span>(<span class="dt">n1 =</span> <span class="dv">287</span>, <span class="dt">n2 =</span> <span class="dv">1147</span>, 
                        <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">power =</span> <span class="ot">NULL</span>, 
                        <span class="dt">d =</span> i, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)
  pwrt4 &lt;-<span class="st"> </span><span class="kw">pwr.t2n.test</span>(<span class="dt">n1 =</span> <span class="dv">430</span>, <span class="dt">n2 =</span> <span class="dv">1004</span>, 
                        <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">power =</span> <span class="ot">NULL</span>, 
                        <span class="dt">d =</span> i, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)
  pwrt5 &lt;-<span class="st"> </span><span class="kw">pwr.t2n.test</span>(<span class="dt">n1 =</span> <span class="dv">574</span>, <span class="dt">n2 =</span> <span class="dv">860</span>, 
                        <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">power =</span> <span class="ot">NULL</span>, 
                        <span class="dt">d =</span> i, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)
  pwrt6 &lt;-<span class="st"> </span><span class="kw">pwr.t2n.test</span>(<span class="dt">n1 =</span> <span class="dv">717</span>, <span class="dt">n2 =</span> <span class="dv">717</span>, 
                        <span class="dt">sig.level =</span> <span class="fl">0.05</span>, <span class="dt">power =</span> <span class="ot">NULL</span>, 
                        <span class="dt">d =</span> i, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>)
  ptab &lt;-<span class="st"> </span><span class="kw">rbind</span>(ptab, <span class="kw">cbind</span>(pwrt1$d, pwrt1$power,
                            pwrt2$d, pwrt2$power,
                            pwrt3$d, pwrt3$power,
                            pwrt4$d, pwrt4$power,
                            pwrt5$d, pwrt5$power,
                            pwrt6$d, pwrt6$power))
}

ptab &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">seq_len</span>(<span class="kw">nrow</span>(ptab)), ptab)

<span class="kw">colnames</span>(ptab) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;id&quot;</span>,<span class="st">&quot;n1=28, n2=1406.effect size&quot;</span>,<span class="st">&quot;n1=28, n2=1406.power&quot;</span>,
                    <span class="st">&quot;n1=144, n2=1290.effect size&quot;</span>,<span class="st">&quot;n1=144, n2=1290.power&quot;</span>,
                    <span class="st">&quot;n1=287, n2=1147.effect size&quot;</span>,<span class="st">&quot;n1=287, n2=1147.power&quot;</span>,
                    <span class="st">&quot;n1=430, n2=1004.effect size&quot;</span>,<span class="st">&quot;n1=430, n2=1004.power&quot;</span>,
                    <span class="st">&quot;n1=574, n2=860.effect size&quot;</span>,<span class="st">&quot;n1=574, n2=860.power&quot;</span>,
                    <span class="st">&quot;n1=717, n2=717.effect size&quot;</span>,<span class="st">&quot;n1=717, n2=717.power&quot;</span>)

<span class="co"># get data into right format for ggplot2</span>
temp &lt;-<span class="st"> </span>ptab %&gt;%
<span class="st">  </span><span class="kw">as.data.frame</span>() %&gt;%
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> name, <span class="dt">value =</span> val, <span class="dv">2</span>:<span class="dv">13</span>) %&gt;%
<span class="st">  </span><span class="kw">separate</span>(<span class="dt">col =</span> name, <span class="dt">into =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;var&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\\</span><span class="st">.&quot;</span>) %&gt;%
<span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> var, <span class="dt">value =</span> val)

<span class="co"># factor group</span>
temp$group &lt;-<span class="st"> </span><span class="kw">factor</span>(temp$group, 
                <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;n1=28, n2=1406&quot;</span>, <span class="st">&quot;n1=144, n2=1290&quot;</span>, 
                <span class="st">&quot;n1=287, n2=1147&quot;</span>, <span class="st">&quot;n1=430, n2=1004&quot;</span>,
                <span class="st">&quot;n1=574, n2=860&quot;</span>, <span class="st">&quot;n1=717, n2=717&quot;</span>))


<span class="co"># plot</span>
p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(temp, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">`</span><span class="dt">effect size</span><span class="st">`</span>, <span class="dt">y =</span> power, <span class="dt">color =</span> group))
p +<span class="st"> </span>
<span class="kw">geom_line</span>(<span class="dt">size=</span><span class="dv">2</span>) +<span class="st"> </span>
<span class="kw">theme_bw</span>() +<span class="st"> </span>
<span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>, 
      <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>), 
      <span class="dt">axis.title=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>), 
      <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</code></pre></div>
</div>
</div>
<div id="model-selection" class="section level3">
<h3><span class="header-section-number">3.2.2</span> Model selection</h3>
</div>
<div id="model-assessment" class="section level3">
<h3><span class="header-section-number">3.2.3</span> Model assessment</h3>
<p>CV</p>
</div>
<div id="calculating-measures-of-uncertainty" class="section level3">
<h3><span class="header-section-number">3.2.4</span> Calculating measures of uncertainty</h3>
<p>Bootstrap</p>
<script src="https://gist.github.com/sahirbhatnagar/9507cc24983103ad9f14.js"></script>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="methods.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/sahirbhatnagar/biosR/edit/master/02-simulations.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
